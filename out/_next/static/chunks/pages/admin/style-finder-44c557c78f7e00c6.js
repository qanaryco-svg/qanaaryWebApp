(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[474],{2197:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/style-finder",function(){return n(9587)}])},2128:function(e,t,n){"use strict";n.r(t),n.d(t,{loadStyleFinderConfig:function(){return loadStyleFinderConfig},recommendByAnswers:function(){return recommendByAnswers},saveStyleFinderConfig:function(){return saveStyleFinderConfig}});var r=n(2929),l=n(8120);function recommendByAnswers(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fa";try{let n=(0,r.QD)(),i=loadStyleFinderConfig(),a={party:["پیراهن","دامن","اکسسوری"],casual:["تی‌شرت","شلوار","هودی","بافت"],work:["کت و کاپشن","دامن","پیراهن"]},o={red:["قرمز","red"],blue:["آبی","blue"],neutral:["سفید","سیاه","خاکی","کت","مشکی"]},s=n.map(n=>{let r=0,s=(0,l.pC)(n,t),c=(s.title||n.title||"").toLowerCase(),d=(s.description||n.description||"").toLowerCase();if(e.occasion){let t=i&&i.occasionMap&&i.occasionMap[e.occasion]||[],l=t.length>0?t:a[e.occasion]||[];l.includes(n.category)&&(r+=3)}if(n.style&&Array.isArray(n.style.tags)){for(let t of n.style.tags)if(e.occasion&&t.toLowerCase().includes(e.occasion)){r+=2;break}}if(e.color){let t=i&&i.colorMap&&i.colorMap[e.color]||[],n=t.length>0?t:o[e.color]||[];for(let e of n)if(c.includes(e)||d.includes(e)){r+=2;break}}if("fitted"===e.silhouette?(c.includes("اسلیم")||d.includes("فیت")||c.includes("fitted"))&&(r+=1):"loose"===e.silhouette&&(c.includes("آزاد")||d.includes("آزاد"))&&(r+=1),e.budget){var u;let t=(u=n.price)<1e5?"low":u<3e5?"mid":"high";t===e.budget&&(r+=2)}return n.price<2e5&&(r+=.2),{product:n,score:r}});return s.sort((e,t)=>t.score-e.score),s.filter(e=>e.score>0).slice(0,12).map(e=>e.product)}catch(e){try{return(0,r.QD)().slice(0,12)}catch(e){return[]}}}let i="qanari:stylefinder:config";function loadStyleFinderConfig(){try{let e=window.localStorage.getItem(i);return e?JSON.parse(e):{}}catch(e){return{}}}function saveStyleFinderConfig(e){try{window.localStorage.setItem(i,JSON.stringify(e)),window.dispatchEvent(new CustomEvent("qanari:stylefinder-updated"))}catch(e){}}},9587:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return AdminStyleFinderPage}});var r=n(5893),l=n(7294),i=n(8675),a=n(2128),o=n(3293);function AdminStyleFinderPage(){let{t:e}=(0,o.Z)(),[t,n]=(0,l.useState)({});(0,l.useEffect)(()=>{n((0,a.loadStyleFinderConfig)())},[]);let updateMap=(e,r)=>{try{let l=JSON.parse(r),i={...t,[e]:l};n(i)}catch(e){alert("JSON نامعتبر است. لطفاً یک شی یا مپ معتبر وارد کنید.")}};return(0,r.jsx)(i.Z,{children:(0,r.jsxs)("div",{className:"p-4 max-w-3xl",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"تنظیمات Style Finder"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"در این صفحه نگاشت‌ها را برای سوالات Style Finder مدیریت کنید. از فرمت JSON استفاده کنید."}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsxs)("label",{className:"block font-medium",children:["occasionMap (مثال: ",'{"party":["پیراهن","اکسسوری"]}',")"]}),(0,r.jsx)("textarea",{className:"w-full h-40 p-2 border rounded mt-1",defaultValue:JSON.stringify(t.occasionMap||{},null,2),onBlur:e=>updateMap("occasionMap",e.currentTarget.value)})]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsxs)("label",{className:"block font-medium",children:["colorMap (مثال: ",'{"red":["قرمز","زرشکی"]}',")"]}),(0,r.jsx)("textarea",{className:"w-full h-40 p-2 border rounded mt-1",defaultValue:JSON.stringify(t.colorMap||{},null,2),onBlur:e=>updateMap("colorMap",e.currentTarget.value)})]}),(0,r.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,r.jsx)("button",{className:"px-4 py-2 bg-qanari text-white rounded",onClick:()=>{(0,a.saveStyleFinderConfig)(t),alert("ذخیره شد")},children:"ذخیره"}),(0,r.jsx)("button",{className:"px-4 py-2 border rounded",onClick:()=>n((0,a.loadStyleFinderConfig)()),children:"بارگذاری"})]})]})})}}},function(e){e.O(0,[424,675,774,888,179],function(){return e(e.s=2197)}),_N_E=e.O()}]);