(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[28],{1088:function(e,s,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/cms",function(){return l(7130)}])},7130:function(e,s,l){"use strict";l.r(s),l.d(s,{default:function(){return AdminCMS}});var a=l(5893),t=l(7294),d=l(8675),r=l(3293);function AdminContentForm(e){let{item:s,onSave:l,onCancel:d}=e,[n,i]=(0,t.useState)(s.title||""),[c,o]=(0,t.useState)(s.slug||""),[u,x]=(0,t.useState)(s.excerpt||""),[m,p]=(0,t.useState)(s.body||""),[h,g]=(0,t.useState)(s.type||"article"),[j,v]=(0,t.useState)(s.media||[]),[b,N]=(0,t.useState)(s.category||""),[f,y]=(0,t.useState)(s.tags||[]),[w,C]=(0,t.useState)(""),[S,_]=(0,t.useState)(s.status||"draft"),{t:D}=(0,r.Z)();(0,t.useEffect)(()=>{i(s.title||""),o(s.slug||""),x(s.excerpt||""),p(s.body||""),g(s.type||"article"),v(s.media||[]),N(s.category||""),y(s.tags||[]),C(""),_(s.status||"draft")},[s]),(0,t.useEffect)(()=>{c||o(n.toLowerCase().replace(RegExp("[^\\p{L}\\p{N}\\s-]+","gu"),"").trim().replace(/\s+/g,"-"))},[n]);let onFile=e=>{if(!e)return;let s=e[0],l=new FileReader;l.onload=()=>{let e=String(l.result||"");v(s=>[e,...s])},l.readAsDataURL(s)},removeMedia=e=>v(s=>s.filter((s,l)=>l!==e)),removeTag=e=>y(s=>s.filter(s=>s!==e));return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsx)("label",{className:"text-sm",children:D("titleLabel")}),(0,a.jsx)("input",{value:n,onChange:e=>i(e.target.value),className:"w-full px-2 py-1 border rounded"})]}),(0,a.jsxs)("div",{className:"mb-2 flex gap-2",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"text-sm",children:"اسلاگ (برای آدرس)"}),(0,a.jsx)("input",{value:c,onChange:e=>o(e.target.value),className:"w-full px-2 py-1 border rounded"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm",children:"وضعیت"}),(0,a.jsxs)("select",{value:S,onChange:e=>_(e.target.value),className:"px-2 py-1 border rounded",children:[(0,a.jsx)("option",{value:"published",children:D("statusPublished")}),(0,a.jsx)("option",{value:"draft",children:D("statusDraft")}),(0,a.jsx)("option",{value:"pending",children:D("statusPending")})]})]})]}),(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsx)("label",{className:"text-sm",children:D("excerptLabel")}),(0,a.jsx)("input",{value:u,onChange:e=>x(e.target.value),className:"w-full px-2 py-1 border rounded"})]}),(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsx)("label",{className:"text-sm",children:D("contentLabel")}),(0,a.jsx)("textarea",{value:m,onChange:e=>p(e.target.value),rows:10,className:"w-full px-2 py-1 border rounded"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsx)("label",{className:"text-sm",children:D("mediaLabel")}),(0,a.jsx)("input",{type:"file",accept:"image/*,video/*",onChange:e=>onFile(e.target.files)}),(0,a.jsx)("div",{className:"mt-2 grid grid-cols-3 gap-2",children:j.map((e,s)=>(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("img",{src:e,className:"w-full h-24 object-cover rounded"}),(0,a.jsx)("button",{onClick:()=>removeMedia(s),className:"absolute top-1 left-1 bg-white/80 rounded px-1 text-sm",children:"\xd7"})]},s))})]}),(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsx)("label",{className:"text-sm",children:D("categoryLabel")}),(0,a.jsx)("input",{value:b,onChange:e=>N(e.target.value),className:"w-full px-2 py-1 border rounded"})]}),(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsx)("label",{className:"text-sm",children:D("tagsLabel")}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{value:w,onChange:e=>C(e.target.value),className:"flex-1 px-2 py-1 border rounded",placeholder:"tag1, tag2"}),(0,a.jsx)("button",{onClick:()=>{let e=w.trim();e&&(f.includes(e)||y(s=>[...s,e]),C(""))},className:"px-3 py-1 border rounded",children:"افزودن"})]}),(0,a.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:f.map(e=>(0,a.jsxs)("div",{className:"px-2 py-1 bg-gray-100 rounded-full flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm",children:e}),(0,a.jsx)("button",{onClick:()=>removeTag(e),className:"text-xs",children:"\xd7"})]},e))})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,a.jsx)("button",{className:"px-3 py-1 border rounded bg-blue-600 text-white",onClick:()=>{let e={...s,title:n,excerpt:u,body:m,type:h,media:j,category:b,tags:f,status:S,updatedAt:Date.now(),createdAt:s.createdAt||Date.now()};e.slug=c,l(e)},children:D("save")}),(0,a.jsx)("button",{className:"px-3 py-1 border rounded",onClick:d,children:D("cancel")})]})]})}var n=l(819);function AdminCMS(){let[e,s]=(0,t.useState)([]),[l,r]=(0,t.useState)(null),[i,c]=(0,t.useState)("همه"),[o,u]=(0,t.useState)("all");(0,t.useEffect)(()=>{(0,n.sI)(),s((0,n.BD)())},[]);let x=["همه",...e.map(e=>e.category||"").filter(Boolean)],onAdd=e=>{let l={...e,id:"c_"+Date.now().toString(36)+Math.random().toString(36).slice(2,8),createdAt:Date.now()};(0,n.tc)(l),s((0,n.BD)()),r(null)},onUpdate=e=>{(0,n.x0)(e),s((0,n.BD)()),r(null)},onDelete=e=>{confirm("آیا مطمئن هستید که می‌خواهید حذف کنید؟")&&((0,n.yd)(e),s((0,n.BD)()))},m=e.filter(e=>("همه"===i||e.category===i)&&("all"===o||e.status===o));return(0,a.jsx)(d.Z,{children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"مدیریت محتوا (CMS)"}),(0,a.jsxs)("div",{className:"mb-4 flex gap-2",children:[(0,a.jsx)("button",{className:"px-3 py-1 border rounded",onClick:()=>r({id:"",title:"",excerpt:"",body:"",type:"article",media:[],category:"",tags:[],status:"draft",createdAt:Date.now()}),children:"افزودن محتوا"}),(0,a.jsx)("select",{value:i,onChange:e=>c(e.target.value),className:"px-2 py-1 border rounded",children:x.map(e=>(0,a.jsx)("option",{value:e,children:e},e))}),(0,a.jsxs)("select",{value:o,onChange:e=>u(e.target.value),className:"px-2 py-1 border rounded",children:[(0,a.jsx)("option",{value:"all",children:"همه"}),(0,a.jsx)("option",{value:"published",children:"منتشر شده"}),(0,a.jsx)("option",{value:"draft",children:"پیش‌نویس"}),(0,a.jsx)("option",{value:"pending",children:"در انتظار تأیید"})]})]}),l?(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsx)(AdminContentForm,{item:l,onSave:e=>l&&l.id?onUpdate(e):onAdd(e),onCancel:()=>r(null)}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:"پیش‌نمایش"}),(0,a.jsxs)("div",{className:"p-4 border rounded",children:[(0,a.jsx)("h2",{className:"font-bold",children:l.title}),(0,a.jsx)("div",{dangerouslySetInnerHTML:{__html:l.body||""}})]})]})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:m.map(e=>{var s;return(0,a.jsxs)("div",{className:"p-3 border rounded",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold",children:e.title}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[e.category," • ",null===(s=e.tags)||void 0===s?void 0:s.join(", ")," • ",e.status]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{className:"px-2 py-1 border rounded",onClick:()=>r(e),children:"ویرایش"}),(0,a.jsx)("button",{className:"px-2 py-1 border rounded text-red-600",onClick:()=>onDelete(e.id),children:"حذف"})]})]}),(0,a.jsx)("div",{className:"mt-2 text-sm",dangerouslySetInnerHTML:{__html:e.excerpt||(e.body||"").slice(0,200)}}),e.media&&e.media.length>0&&(0,a.jsx)("div",{className:"mt-2 flex gap-2",children:e.media.map(s=>(0,a.jsx)("div",{className:"w-24 h-24 overflow-hidden rounded",children:"image"===e.type?(0,a.jsx)("img",{src:s,alt:e.title,className:"w-full h-full object-cover"}):(0,a.jsx)("video",{src:s,className:"w-full h-full object-cover",controls:!0})},s))})]},e.id)})})]})})}}},function(e){e.O(0,[424,675,774,888,179],function(){return e(e.s=1088)}),_N_E=e.O()}]);