(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[635],{7061:function(e,s,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/users",function(){return l(7923)}])},7923:function(e,s,l){"use strict";l.r(s),l.d(s,{default:function(){return AdminUsers}});var n=l(5893),r=l(7294),t=l(8675),d=l(4702),a=l(8366);function AdminUsers(){let[e,s]=(0,r.useState)([]),[l,i]=(0,r.useState)("");(0,r.useEffect)(()=>{s((0,d.loadMembers)())},[]);let o=e.filter(e=>e.name.toLowerCase().includes(l.toLowerCase())||e.email.toLowerCase().includes(l.toLowerCase())),onDelete=e=>{confirm("آیا مطمئن هستید؟")&&((0,d.deleteMemberByEmail)(e),s((0,d.loadMembers)()))},onToggleBlock=(e,l)=>{(0,d.setMemberBlocked)(e,!l),s((0,d.loadMembers)())},onChangeRole=(e,l)=>{(0,d.setMemberRole)(e,l),s((0,d.loadMembers)())},onEdit=e=>{let l=prompt("نام",e.name)||e.name,n=prompt("شهر",e.city||"")||e.city,r={...e,name:l,city:n};(0,d.updateMember)(r),s((0,d.loadMembers)())},[c,m]=(0,r.useState)(null),showActivity=e=>{let s=(0,a.listActivityForMember)(e);m(s)};return(0,n.jsx)(t.Z,{children:(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"کاربران"}),(0,n.jsx)("div",{className:"mb-4 flex gap-2",children:(0,n.jsx)("input",{value:l,onChange:e=>i(e.target.value),placeholder:"جستجو با نام یا ایمیل",className:"px-3 py-2 border rounded flex-1"})}),(0,n.jsx)("div",{className:"grid grid-cols-1 gap-2",children:o.map(e=>(0,n.jsxs)("div",{className:"p-3 border rounded flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"font-semibold",children:[e.name," ",e.blocked?(0,n.jsx)("span",{className:"text-xs text-red-600",children:"(مسدود)"}):null]}),(0,n.jsx)("div",{className:"text-sm text-gray-600",children:e.email}),(0,n.jsxs)("div",{className:"text-sm text-gray-600",children:["نقش: ",e.role||"buyer"]})]}),(0,n.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,n.jsxs)("select",{value:e.role||"buyer",onChange:s=>onChangeRole(e.id,s.target.value),className:"px-2 py-1 border rounded",children:[(0,n.jsx)("option",{value:"buyer",children:"خریدار"}),(0,n.jsx)("option",{value:"seller",children:"فروشنده"}),(0,n.jsx)("option",{value:"admin",children:"ادمین"})]}),(0,n.jsx)("button",{className:"px-3 py-1 border rounded",onClick:()=>onEdit(e),children:"ویرایش"}),(0,n.jsx)("button",{className:"px-3 py-1 border rounded",onClick:()=>showActivity(e.id),children:"تاریخچه"}),(0,n.jsx)("button",{className:"px-3 py-1 border rounded",onClick:()=>onToggleBlock(e.id,e.blocked),children:e.blocked?"فعال‌سازی":"مسدود"}),(0,n.jsx)("button",{className:"px-3 py-1 border rounded text-red-600",onClick:()=>onDelete(e.email),children:"حذف"})]})]},e.email))}),c?(0,n.jsxs)("div",{className:"mt-4 p-3 border rounded",children:[(0,n.jsx)("h3",{className:"font-semibold mb-2",children:"تاریخچه فعالیت"}),0===c.length?(0,n.jsx)("div",{className:"text-sm text-gray-600",children:"فعالیتی پیدا نشد"}):(0,n.jsx)("ul",{className:"space-y-2 text-sm",children:c.map(e=>(0,n.jsxs)("li",{className:"p-2 border rounded",children:[(0,n.jsx)("div",{className:"font-medium",children:e.type}),(0,n.jsx)("div",{className:"text-gray-600",children:new Date(e.ts).toLocaleString()}),(0,n.jsx)("div",{className:"text-xs",children:JSON.stringify(e.payload)})]},e.id))}),(0,n.jsx)("div",{className:"mt-2",children:(0,n.jsx)("button",{className:"px-3 py-1 border rounded",onClick:()=>m(null),children:"بستن"})})]}):null]})})}}},function(e){e.O(0,[424,675,774,888,179],function(){return e(e.s=7061)}),_N_E=e.O()}]);