(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[222],{7250:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/checkout",function(){return r(175)}])},175:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return CheckoutPage}});var a=r(5893),n=r(7294),d=r(1159),i=r(2463),s=r(3293),l=r(4858);let c=r(158),o=r(4702);function CheckoutPage(){let{items:e,clear:t}=(0,l.j)(),[r,u]=(0,n.useState)("gateway"),[x,m]=(0,n.useState)(!1),[p,h]=(0,n.useState)(null),[y,N]=(0,n.useState)(null),g=e.reduce((e,t)=>e+t.product.price*t.quantity,0),{t:b}=(0,s.Z)();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.Z,{}),(0,a.jsxs)("main",{className:"container py-8",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:b("paymentPageTitle")}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"p-4 border rounded",children:[(0,a.jsxs)("div",{className:"font-semibold",children:[b("cartTotal"),": ",g.toLocaleString()," تومان"]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[b("itemsCount"),": ",e.length]})]}),(0,a.jsxs)("div",{className:"p-4 border rounded",children:[(0,a.jsx)("label",{className:"block mb-2",children:b("paymentMethod")}),(0,a.jsxs)("select",{value:r,onChange:e=>u(e.target.value),className:"border p-2 rounded",children:[(0,a.jsx)("option",{value:"gateway",children:b("gatewayOption")}),(0,a.jsx)("option",{value:"crypto",children:b("cryptoOption")})]})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{className:"px-4 py-2 bg-qanari text-qanariDark font-semibold rounded",onClick:()=>{if(0===e.length)return N(b("emptyCart"));m(!0);let t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),a=o.currentMember?o.currentMember():null,n=a?a.referrerId:void 0,d={id:t,memberEmail:a?a.email:void 0,items:e.map(e=>({productId:e.product.id,quantity:e.quantity})),total:g,status:"pending",referrerId:n,createdAt:Date.now()};try{c.addOrder(d);let e="INV-".concat(String(t).slice(0,8));h(e),N(b("invoiceCreated").replace("{code}",e).replace("{method}","gateway"===r?b("gatewayOption"):b("cryptoOption")))}catch(e){N(b("invoiceError"))}m(!1)},disabled:x,children:b("startPayment")}),p&&"gateway"===r&&(0,a.jsx)("button",{className:"px-4 py-2 border rounded",onClick:()=>{if(!p)return N(b("invoiceNotStarted"));let e=c.loadOrders(),r=e.find(e=>e.id&&e.id.startsWith(p.replace("INV-","")));if(!r)return N(b("orderNotFound"));let a={...r,status:"paid"};c.deleteOrder(r.id),c.addOrderWithLevelPercents(a,[.5,1,.1]),t(),N(b("paymentSimulatedGateway")),h(null)},children:b("simulateGatewayReturn")}),p&&"crypto"===r&&(0,a.jsx)("button",{className:"px-4 py-2 border rounded",onClick:()=>{if(!p)return N(b("invoiceNotStarted"));let e=c.loadOrders(),r=e.find(e=>e.id&&e.id.startsWith(p.replace("INV-","")));if(!r)return N(b("orderNotFound"));let a={...r,status:"paid"};c.deleteOrder(r.id),c.addOrderWithLevelPercents(a,[.5,1,.1]),t(),N(b("paymentSimulatedCrypto")),h(null)},children:b("simulateCryptoConfirm")})]}),p&&(0,a.jsxs)("div",{className:"p-4 mt-4 border rounded bg-gray-50",children:[(0,a.jsxs)("div",{className:"font-medium",children:["کد پرداخت / فاکتور: ",p]}),"crypto"===r&&(0,a.jsx)("div",{className:"text-sm mt-2",children:"آدرس پرداخت (نماد): 0xDEADBEEF... (نمونه)"})]}),y&&(0,a.jsx)("div",{className:"mt-4 p-3 rounded bg-green-50 text-green-800",children:y})]})]}),(0,a.jsx)(i.Z,{})]})}}},function(e){e.O(0,[424,607,774,888,179],function(){return e(e.s=7250)}),_N_E=e.O()}]);