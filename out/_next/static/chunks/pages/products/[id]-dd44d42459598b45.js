(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[304],{2818:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/products/[id]",function(){return r(4285)}])},5739:function(e,t,r){"use strict";r.d(t,{R:function(){return a}});let a=[{id:"p1",title:"پیراهن بهاری قناری",price:129e3,images:["/p1.svg"],description:"پیراهن سبک و رنگی مناسب فصل بهار.",category:"پیراهن",discount:15},{id:"p2",title:"شال ابریشمی",price:89e3,images:["/p2.svg"],description:"شال ابریشمی با الگوهای شکیل.",category:"شال",discount:0},{id:"p3",title:"کت تک مجلسی",price:35e4,images:["/p3.svg"],description:"کت تک با برش‌ فلسفه‌مند برای مهمانی‌ها.",category:"کت و کاپشن",discount:10},{id:"p4",title:"دامن کلوش",price:99e3,images:["/p4.svg"],description:"دامن کلوش مناسب استایل روزمره.",category:"دامن"},{id:"p5",title:"شلوار جین برازنده",price:149e3,images:["/p5.svg"],description:"شلوار جین با برش راحت و شیک.",category:"شلوار"},{id:"p6",title:"اکسسوری طلایی",price:45e3,images:["/p6.svg"],description:"گردنبند و گوشواره ست.",category:"اکسسوری"},{id:"p7",title:"کفش اسپرت راحت",price:22e4,images:["/p7.svg"],description:"کفش اسپرت مناسب پیاده‌روی و باشگاه.",category:"کفش"},{id:"p8",title:"هودی گرم و نرم",price:179e3,images:["/p8.svg"],description:"هودی با جنس ملایم و ضدپیلینگ.",category:"هودی"},{id:"p9",title:"تی‌شرت نخی ساده",price:69e3,images:["/p9.svg"],description:"تی‌شرت نخی با برش استاندارد و رنگ‌های متنوع.",category:"تی‌شرت"},{id:"p10",title:"تاپ کتان",price:49e3,images:["/p10.svg"],description:"تاپ راحتی برای استایل تابستانی.",category:"تاپ"},{id:"p11",title:"ست ورزشی",price:239e3,images:["/p11.svg"],description:"ست ورزشی قابل تنفس و خشک‌شونده سریع.",category:"لباس ورزشی"},{id:"p12",title:"ژاکت بافتنی",price:199e3,images:["/p12.svg"],description:"بافتنی دست‌دوخت با الیاف نرم.",category:"بافت"},{id:"p13",title:"کفش پاشنه‌دار شیک",price:32e4,images:["/p13.svg"],description:"کفش پاشنه‌دار مناسب مجالس و مهمانی‌ها.",category:"کفش"},{id:"p14",title:"ست زیرپوش راحت",price:79e3,images:["/p14.svg"],description:"زیرپوش نرم و ضدحساسیت برای استفاده روزمره.",category:"لباس زیر"},{id:"p15",title:"جوراب‌های جور",price:19e3,images:["/p15.svg"],description:"جوراب‌های با کیفیت در بسته‌های چندتایی.",category:"جوراب"}]},2929:function(e,t,r){"use strict";r.d(t,{GC:function(){return resetProducts},Ir:function(){return deleteProduct},QD:function(){return loadProducts},V_:function(){return findProduct},gK:function(){return addProduct},nM:function(){return updateProduct}});var a=r(5739);let s="qanari:products";function loadProducts(){try{let e=localStorage.getItem(s);if(e)return JSON.parse(e)}catch(e){}try{let e=a.R.map(e=>({...e}));return localStorage.setItem(s,JSON.stringify(e)),e}catch(e){return a.R}}function saveProducts(e){localStorage.setItem(s,JSON.stringify(e));try{window.dispatchEvent(new CustomEvent("qanari:products-updated"))}catch(e){}try{if("undefined"!=typeof BroadcastChannel){let e=new BroadcastChannel("qanari:products");e.postMessage({type:"updated"}),e.close()}}catch(e){}}function resetProducts(){try{let e=a.R.map(e=>({...e}));localStorage.setItem(s,JSON.stringify(e)),window.dispatchEvent(new CustomEvent("qanari:products-updated"));try{if("undefined"!=typeof BroadcastChannel){let e=new BroadcastChannel("qanari:products");e.postMessage({type:"reset"}),e.close()}}catch(e){}return!0}catch(e){return!1}}function findProduct(e){if(!e)return;let t=loadProducts();return t.find(t=>t.id===e)}function addProduct(e){let t=loadProducts();t.unshift(e),saveProducts(t)}function updateProduct(e){let t=loadProducts(),r=t.findIndex(t=>t.id===e.id);r>=0&&(t[r]=e),saveProducts(t)}function deleteProduct(e){let t=loadProducts().filter(t=>t.id!==e);saveProducts(t)}},4285:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return ProductPage}});var a=r(5893),s=r(1163),i=r(1159),n=r(2463),l=r(4858),c=r(7294),d=r(2929),o=r(3790),u=r(3293);let p="qanari:comments";function ProductComments(e){var t,r,s,i,n;let{productId:l,onStatsChange:d}=e,[m,g]=(0,c.useState)({}),[x,h]=(0,c.useState)({}),[v,f]=(0,c.useState)({}),y=["کثافت","فحش","لعنت","تبلیغ","spam","ad","فروش","خرید","xxx","http","www"],isClean=e=>{let t=e.toLowerCase();return!y.some(e=>t.includes(e))},[j,N]=(0,c.useState)([]),[b,w]=(0,c.useState)({}),[S,C]=(0,c.useState)(""),[P,q]=(0,c.useState)(5),[I,k]=(0,c.useState)(""),{lang:L,t:E}=(()=>{try{return(0,u.Z)()}catch(e){return{lang:"fa",t:e=>e}}})(),A=(()=>{try{return(0,o.d)()}catch(e){return}})();(0,c.useEffect)(()=>{try{let e=localStorage.getItem("qanari:commentReplies"),t=e?JSON.parse(e):{};g(t)}catch(e){g({})}try{let e=localStorage.getItem(p),t=e?JSON.parse(e):[],r=t.filter(e=>e.productId===l).sort((e,t)=>t.createdAt-e.createdAt),a=(()=>{try{return localStorage.getItem("qanari:comments-seeded")}catch(e){return null}})();if(0===r.length&&!a){let e="en"===L?["Mahsa","Nasrin","Ava","Sara","Maryam","Negar","Pari"]:["مهسا","نسرین","آوا","سارا","مریم","نگار","پری"],r="en"===L?["Very nice and good quality, I am satisfied with my purchase.","Great texture and the size matched the description.","Fast shipping though the packaging could be better.","The color was exactly like the photo, I recommend it.","Affordable price and comfortable for everyday use.","Durable material, perfect for autumn.","It runs a bit large; consider ordering one size down."]:"ar"===L?["جيد جدا وبجودة عالية، أنا راضٍ عن شرائي.","نسيج رائع والحجم مطابق للوصف.","كانت الشحنة سريعة لكن التغليف يمكن أن يكون أفضل.","اللون مطابق للصورة تمامًا، أنصح به.","سعر مناسب ومريح للاستخدام اليومي.","خامة متينة وممتازة لفصل الخريف.","المقاس كبير قليلاً، اختر مقاسًا أصغر."]:["خیلی خوب و با کیفیت بود، از خریدم راضی‌ام.","بافت عالی و اندازه‌اش مطابق توضیحات بود.","ارسال سریع بود اما بسته‌بندی بهتر می‌توانست باشد.","رنگ دقیقاً مثل عکس بود، پیشنهاد می‌کنم.","قیمت مناسب و راحت است برای استفاده روزمره.","دوام و جنس مناسب، برای فصل پاییز عالی بود.","اندازه‌اش کمی بزرگ است، یک سایز کوچک‌تر انتخاب کنید."],a=[],s=Date.now();for(let t=0;t<7;t++)a.push({id:"".concat(l,"-seed-").concat(t,"-").concat(s),productId:l,name:e[t%e.length],rating:5-t%5,text:r[t%r.length],createdAt:s-1e3*t});let i=[...a,...t];persistAll(i);try{localStorage.setItem("qanari:comments-seeded","true")}catch(e){}let n=i.filter(e=>e.productId===l).sort((e,t)=>t.createdAt-e.createdAt);if(N(n),d){let e=n.length,t=n.reduce((e,t)=>e+(t.rating||0),0);d({avg:0===e?0:t/e,count:e})}return}N(r);try{let e=localStorage.getItem("qanari:commentLikes"),t=e?JSON.parse(e):{};w(t)}catch(e){w({})}if(d){let e=r.length,t=r.reduce((e,t)=>e+(t.rating||0),0);d({avg:0===e?0:t/e,count:e})}}catch(e){N([])}},[l]);let persistAll=e=>{try{localStorage.setItem(p,JSON.stringify(e))}catch(e){}};return(0,a.jsxs)("div",{className:"mt-12",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold mb-4",children:null!==(t=E("userComments"))&&void 0!==t?t:"نظرات کاربران"}),(0,a.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!I.trim()||!S.trim())return;let t={id:String(Date.now()),productId:l,name:S.trim(),rating:P,text:I.trim(),createdAt:Date.now()};try{var r;let e=localStorage.getItem(p),a=e?JSON.parse(e):[],s=[t,...a];persistAll(s);let i=s.filter(e=>e.productId===l).sort((e,t)=>t.createdAt-e.createdAt);if(N(i),d){let e=i.length,t=i.reduce((e,t)=>e+(t.rating||0),0);d({avg:0===e?0:t/e,count:e})}k(""),A&&A.push(null!==(r=E("commentSaved"))&&void 0!==r?r:"نظر شما ثبت شد",{level:"success"})}catch(e){}},className:"mb-6 space-y-3",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{value:S,onChange:e=>C(e.target.value),placeholder:null!==(r=E("yourName"))&&void 0!==r?r:"نام شما",className:"flex-1 px-3 py-2 border rounded"}),(0,a.jsx)("select",{value:P,onChange:e=>q(Number(e.target.value)),className:"px-3 py-2 border rounded",children:[5,4,3,2,1].map(e=>{var t;return(0,a.jsxs)("option",{value:e,children:[e," ",null!==(t=E("stars"))&&void 0!==t?t:"ستاره"]},e)})})]}),(0,a.jsx)("div",{children:(0,a.jsx)("textarea",{value:I,onChange:e=>k(e.target.value),placeholder:null!==(s=E("yourCommentPlaceholder"))&&void 0!==s?s:"نظر شما دربارهٔ این محصول",className:"w-full px-3 py-2 border rounded",rows:4})}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 bg-qanari text-qanariDark rounded font-semibold",children:null!==(i=E("submitComment"))&&void 0!==i?i:"ثبت نظر"})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[0===j.length&&(0,a.jsx)("div",{className:"text-gray-600",children:null!==(n=E("noCommentsYet"))&&void 0!==n?n:"هنوز نظری ثبت نشده است."}),j.map(e=>(0,a.jsxs)("div",{className:"border rounded p-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("div",{className:"font-semibold",children:e.name}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:new Date(e.createdAt).toLocaleString()})]}),(0,a.jsxs)("div",{className:"text-sm text-yellow-600 mb-2",children:["★".repeat(e.rating),"☆".repeat(5-e.rating)]}),(0,a.jsx)("div",{className:"text-gray-800 mb-2",children:e.text}),(0,a.jsxs)("div",{className:"flex flex-row-reverse items-center gap-3 mt-2",children:[(0,a.jsxs)("button",{className:"text-sm text-pink-600 flex items-center gap-1",onClick:()=>{let t={...b,[e.id]:(b[e.id]||0)+1};w(t);try{localStorage.setItem("qanari:commentLikes",JSON.stringify(t))}catch(e){}},children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:(0,a.jsx)("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41 1.01 4.5 2.09C13.09 4.01 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}),(0,a.jsx)("span",{children:b[e.id]||0})]}),(0,a.jsxs)("form",{onSubmit:t=>{var r;t.preventDefault();let a=(null===(r=x[e.id])||void 0===r?void 0:r.trim())||"";if(!a)return;if(!isClean(a)){A&&A.push("پاسخ شما شامل تبلیغ یا فحاشی است.",{level:"error"});return}let s={...m,[e.id]:[...m[e.id]||[],a]};g(s),h({...x,[e.id]:""});try{localStorage.setItem("qanari:commentReplies",JSON.stringify(s))}catch(e){}},className:"flex items-center gap-1",children:[(0,a.jsx)("input",{type:"text",value:x[e.id]||"",onChange:t=>h({...x,[e.id]:t.target.value}),placeholder:"پاسخ کوتاه...",className:"border rounded px-2 py-1 text-sm",maxLength:64}),(0,a.jsx)("button",{type:"submit",className:"text-xs px-2 py-1 bg-qanari text-qanariDark rounded",children:"ثبت"})]})]}),m[e.id]&&m[e.id].length>0&&(0,a.jsxs)("div",{className:"mt-2 text-left",children:[(0,a.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"پاسخ‌ها:"}),(0,a.jsx)("ul",{className:"space-y-1",children:m[e.id].slice(0,v[e.id]?void 0:3).map((e,t)=>(0,a.jsx)("li",{className:"text-xs bg-gray-100 rounded px-2 py-1",children:e},t))}),m[e.id].length>3&&!v[e.id]&&(0,a.jsxs)("button",{onClick:()=>f({...v,[e.id]:!0}),className:"text-xs text-qanariDark bg-qanari bg-opacity-20 hover:bg-opacity-30 rounded px-2 py-1 mt-1 transition-colors",children:[m[e.id].length-3," پاسخ بیشتر..."]})]})]},e.id))]})]})}var m=r(8120),g=r(5152),x=r.n(g);let h=x()(()=>r.e(623).then(r.bind(r,1960)),{loadableGenerated:{webpack:()=>[1960]},ssr:!1});function ProductPage(){var e;let t=(0,s.useRouter)(),{id:r}=t.query,[o,p]=(0,c.useState)(),{add:g}=(0,l.j)(),[x,v]=(0,c.useState)(null),[f,y]=(0,c.useState)(!1);(0,c.useEffect)(()=>{let e;if(!r)return;let load=()=>{let e=(0,d.V_)(String(r));p(e)};load();let onUpdate=()=>{load()},onStorage=e=>{"qanari:products"===e.key&&onUpdate()};window.addEventListener("qanari:products-updated",onUpdate),window.addEventListener("storage",onStorage);try{"undefined"!=typeof BroadcastChannel&&((e=new BroadcastChannel("qanari:products")).onmessage=()=>onUpdate())}catch(e){}return()=>{window.removeEventListener("qanari:products-updated",onUpdate),window.removeEventListener("storage",onStorage);try{e&&e.close()}catch(e){}}},[r]);let{t:j,lang:N}=(0,u.Z)();return o?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Z,{}),(0,a.jsxs)("main",{className:"container py-8",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsx)(Gallery,{images:o.images,title:(0,m.pC)(o,N).title}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-2",children:(0,m.pC)(o,N).title}),x&&x.count>0&&(0,a.jsxs)("div",{className:"text-sm bg-white/90 px-2 py-1 rounded shadow",children:[(0,a.jsx)("span",{className:"font-semibold",children:x.avg.toFixed(1)}),(0,a.jsx)("span",{className:"text-yellow-500",children:" ★"}),(0,a.jsxs)("span",{className:"text-gray-500",children:[" (",x.count,")"]})]})]}),(0,a.jsxs)("p",{className:"text-lg text-gray-700 mb-4",children:[o.price.toLocaleString()," تومان"]}),(0,a.jsx)("p",{className:"text-gray-600",children:(0,m.pC)(o,N).description}),(0,a.jsxs)("div",{className:"mt-4 flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"flex gap-2 items-center mb-2",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600",children:"سایز:"}),"کفش"===o.category?(0,a.jsxs)("select",{className:"border rounded px-2 py-1 text-sm",children:[(0,a.jsx)("option",{value:"",children:"انتخاب کنید"}),[...Array(10)].map((e,t)=>{let r=36+t;return(0,a.jsx)("option",{value:r,children:r},r)})]}):(0,a.jsxs)("select",{className:"border rounded px-2 py-1 text-sm",children:[(0,a.jsx)("option",{value:"",children:"انتخاب کنید"}),(0,a.jsx)("option",{value:"S",children:"S"}),(0,a.jsx)("option",{value:"M",children:"M"}),(0,a.jsx)("option",{value:"L",children:"L"}),(0,a.jsx)("option",{value:"XL",children:"XL"}),(0,a.jsx)("option",{value:"XXL",children:"XXL"})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 items-center mb-2",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600",children:"رنگ:"}),(0,a.jsxs)("select",{className:"border rounded px-2 py-1 text-sm",children:[(0,a.jsx)("option",{value:"",children:"انتخاب کنید"}),(0,a.jsx)("option",{value:"قرمز",children:"قرمز"}),(0,a.jsx)("option",{value:"آبی",children:"آبی"}),(0,a.jsx)("option",{value:"زرد",children:"زرد"}),(0,a.jsx)("option",{value:"سبز",children:"سبز"}),(0,a.jsx)("option",{value:"مشکی",children:"مشکی"}),(0,a.jsx)("option",{value:"سفید",children:"سفید"})]})]}),(0,a.jsx)("button",{className:"px-4 py-2 bg-qanari text-qanariDark rounded font-semibold mr-2",onClick:()=>g(o,1),children:j("addToCart")})]})]})]}),(0,a.jsx)(ProductComments,{productId:o.id,onStatsChange:e=>v(e)})]}),(0,a.jsx)(n.Z,{}),f&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"w-full max-w-3xl",children:[(0,a.jsx)(h,{overlayUrl:null===(e=o.images)||void 0===e?void 0:e[0]}),(0,a.jsx)("div",{className:"mt-2 text-right",children:(0,a.jsx)("button",{className:"px-3 py-1 border rounded",onClick:()=>y(!1),children:"Close"})})]})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Z,{}),(0,a.jsx)("main",{className:"container py-8",children:j("productNotFound")}),(0,a.jsx)(n.Z,{})]})}function Gallery(e){let{images:t,title:r}=e,[s,i]=(0,c.useState)(t&&t.length>0?t[0]:null),{t:n}=(0,u.Z)();(0,c.useEffect)(()=>{i(t&&t.length>0?t[0]:null)},[t]);let isVideo=e=>e.startsWith("data:video")||e.endsWith(".mp4")||e.includes("video");return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"w-full h-96 bg-gray-100 rounded flex items-center justify-center overflow-hidden",children:s?isVideo(s)?(0,a.jsx)("video",{src:s,controls:!0,className:"w-full h-full object-contain"}):(0,a.jsx)("img",{src:s,alt:r,className:"w-full h-full object-cover"}):(0,a.jsx)("div",{className:"text-gray-500",children:n("noImage")})}),(0,a.jsx)("div",{className:"mt-3 grid grid-cols-5 gap-2",children:t.map((e,t)=>(0,a.jsx)("button",{onClick:()=>i(e),className:"border rounded overflow-hidden",children:isVideo(e)?(0,a.jsx)("video",{src:e,className:"w-full h-20 object-cover"}):(0,a.jsx)("img",{src:e,className:"w-full h-20 object-cover"})},t))})]})}}},function(e){e.O(0,[424,607,774,888,179],function(){return e(e.s=2818)}),_N_E=e.O()}]);